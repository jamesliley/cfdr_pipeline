*****************************************************************
*--  Summary of simulation data                               --*
*--                                                           --*
*--  'Accurate error control in high dimensional association  --*
*--  testing using conditional false discovery rates'         --*
*--                                                           --*
*--  James Liley and Chris Wallace                            --*
*--  2019                                                     --*
*****************************************************************

This readme is to describe the matrices of simulation results

All simulations are generated by

../code/run_simulation.R

and analysed in

../code/simulation_analysis.R


Files simmat0.1 and simmat0.01 are comma-separated matrices
containing the following columns. Variables are explained in the 
supplementary material, section 'Simulation protocol'. Simulations 
are oversampled with n1p+n1pq=0.

[1] seed: random seed used to generate the simulation. To 
  reproduce the results of a given run of the simulation, run
  the script ../code/run_simulation.R with the variable 'seed'
  set to this value.
[2] alpha: FDR control level. Either 0.1 or 0.01
[3] N: number of variables
[4] dist1: TRUE effect size distribution for non-null effects.
  1 corresponds to normal, 2 to t (3df), 3 to Cauchy.
[5] dist2: ASSUMED effect size distribution for modelling 
  Z_Q|HP0 and integrating over L. Always 1 (normal).
[6] n1p: number of variables associated with P
[7] n1q: number of variables associated with Q
[8] n1pq: number of variables associated with P and Q
[9] sp: scale of effect size distribution for variables 
  associated with P
[10] sq: scale of effect size distribution for variables 
  associated with Q
[11-17] fit_{x}: parameters of bivariate Gaussian-mixture 
  model for distribution of P,Q. {x} can be in {pi0,pi1,pi2,
  tau1,tau2,sigma1,sigma2}.
[18] fit_conv: indicator for convergence of mixture-Gaussian 
  model.
[19-20] {x}_null: parameters of bivariate Gaussian fitted to 
  distribution of Q|P>0.5. {x} can be in {pi0,sigma}.
[21-214] {A}_cf{B}_fdr{C}_adj{D}_dist{E}_fold{F}: results 
  from simulations. 
  {A}: either fdp or tdr
  {B}: 1-7: type of cfdr estimator. 1: ordinary ECDF. 2: KDE-based
    CDF estimatino. 3: Parametric CDF estimation. 4: KDE-based PDF
    estimation. 5: Parametric PDF estimation. 6: Oracle (correct) 
    PDF estimation. 7: Oracle (correct) CDF estimation.
  {C}: 1,2,3,3b, or 4: type of FDR control method. 1: Original 
    method (outdated). 2: naive method with no leaving points out.
    3: leave out points by block. 4: leave out one point at once. 
  {D}: 0 or 1: include estimate of Pr(Q<q|HP0) in estimator of
    cFDR. 
  {E}: 1 or 2: distribution of P,Q|HP0 used for integration 
    over L-regions. 1 indicates the true distribution, 2 the
    estimated distribution parametrised by pi0_null,sigma_null,
    dist2.
  {F}: 1,2, or 3: fold, only relevant if C=3. Corresponds to
    within-fold FDP/TDR
  Not all combinations are present.
  Also contains fdp_p and tdr_p corresponding to FDP and TDR of 
    the Benjamini-Hochberg method applied to p-values.

